---
title: "Android SDK - Push Notifications (FCM)"
---

Weâ€™ll show you how to send push notifications and/or push messages to your customers, with Firebase Cloud Messaging (FCM) in Skara Chat.

### **Topics covered:**

- [Enable Google Services For Your App](#enable-google-services-for-your-app)
- [Set Up Client to Receive Push](#set-up-client-to-receive-push)
- [Enable Push Notification in Skara](#enable-push-notification-in-salesmate)
- [Disable Push on Logout](#disable-push-on-logout)
- [Using Skara Chat with FCM - Setup](#using-salesmate-chat-with-fcm-setup)
- [Trouble Shooting Tips](#trouble-shooting-tips)

### Enable Google Services For Your App

- If you already have a Firebase project with notifications enabled you can skip to the next step. Otherwise, go to the [FCM Console page](https://console.firebase.google.com/) and create a new project following these steps:
- Give the project a name and click â€˜Create Projectâ€™.

![Create Firebase Project](images/008-create-firebase-project-10009268287641.png)

- Once your project is set up, scroll down and select the â€˜Cloud Messagingâ€™â€™ card.

![Select Cloud Messaging](images/009-select-cloud-messaging-10009252534297.png)

- Click on the Android icon to continue the setup.
- Enter your appâ€™s package name and click â€˜Register Appâ€™.

<img src="images/010-register-app-10009307437977.png" alt="Register App" />

### Set Up Client to Receive Push

- Click the button "Download google-services.json" to download the config file. Youâ€™ll need to move that file into the same directory as your application level `` `build.gradle` ``.

![Download google-services.json](images/011-download-google-servicesjson-10009307097753.png)

- Click "next" and then in your apps `` `build.gradle` `` you will need to add the following lines to your dependencies:

```gradle
dependencies {
    // implementation 'Coming Soon'
    implementation 'com.google.firebase:firebase-messaging:20.2.'
}
```

- At the bottom of your `` `build.gradle` `` you must add: `apply plugin: 'com.google.gms.google-services'`
- It is important that this is at the very end of the file.
- Click the Next button and then skip the verification step.

### Enable Push Notification in Skara

- Finally, click the settings cog and select â€˜Project settingsâ€™, then â€˜Cloud Messaging tabâ€™ then Cloud Messaging tab.

![Project Settings](images/012-project-settings-35524153104025.png)

- For new FCM projects, Firebase Cloud Messaging API v1 is enabled by default. If it's disabled in an older project, you can enable it in Google Cloud Console by clicking the three dots icon, selecting Manage API, and then clicking the Enable button. - Under the Project settings page, select the Service Accounts tab and under Firebase Admin SDK, ensure that Node.js is selected and then click on Generate new private key

![Generate new private key](images/013-generate-new-private-key-35524136173337.png)

- Open your Skara Messenger settings and select â€˜Installation â†’ Androidâ€™. Then find the â€˜Enable Push Notificationsâ€™ section. Here you'll be able to paste and save your Server API key.

![Enable Push Notifications](images/014-enable-push-notifications-35523620113305.png)

### Disable Push on Logout

- To stop users from receiving push messages when they have logged out of the app make sure to call:

```
SalesmateChatSDK.getInstance().logout()
```

### Using Skara Chat with FCM - Setup

- If your application uses FCM for your own content, or if you use a third-party service for FCM. Youâ€™ll need to update your `` `FirebaseMessagingService` ``.
- You should have a class that extends `` `FirebaseMessagingService.` `` That service is where you get the device token to send to your backend to register for the push. To register for Skara Chat push set it up like this:

```kotlin
override fun onNewToken(token: String) {}
 super.onNewToken(token)
 SalesmatePushClient.getInstance().sendTokenToSalesmate(token)

override fun onMessageReceived(remoteMessage: RemoteMessage) {}
 super.onMessageReceived(remoteMessage)
 val valueMap: MutableMap<String, String> = remoteMessage.data

 if (SalesmatePushClient.getInstance().isSalesmateChatSDKPush(valueMap)) {}

 SalesmatePushClient.getInstance().handleSalesmateChatSDKPush(valueMap)
 return
```

> 
>
> <Tip>
>   ðŸ“˜**Important**\> The recommendation of **sendTokenToSkara()**is to call it on the initial launch of an app to update the fresh firebase token into Skara
> </Tip>

If youâ€™re having trouble getting FCM to work in your app, here's a list of things you should check:

- Check that the notifications are not disabled for your app on your test device.
- **Settings \> Sound & Notification \> App notifications** _._ This may differ depending on the Android version.
- Did you specify the correct Push Server API key?
- Make sure you added your `` `google-services.json` `` file in the correct directory.